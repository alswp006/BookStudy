# 패키지, jar, 배포.md
- 자바 프로그램은 클래스 여러 개가 모여있는 것이다. 개발을 하고 나면 결과물로 클래스가 만들어진다.
- 사용자의 환경은 개발자의 환경과 다를 수 있기 때문에 모양새를 갖춰서 배포행한다.
- 배포 방법
  1. 로컬 : 애플리케이션 전체가 사용자의 컴퓨터에서 실행 가능한 JAR로 배포된 독립적인 프로그램으로 실행된다.
  2. 로컬과 원격의 혼합형 : 애클리케이션의 일부분이 돌아가고 있는 서버와 사용자의 로컬 시스템에서 실행되며 서버에 연결되어 작업을 처리하는 클라이언트 부분으로 나눠져 있다.
  3. 원격 : 자바 애플리케이션 전체가 서버 시스템에서 돌아가고 클라이언트는 웹 브라우저와 같이 자바를 사용하지 않는 방법을 통해서 서버에 접근한다.
## 소스 코드와 클래스 파일의 분리
- 한 디렉토리에 소스 코드와 클래스 파일이 아무렇게나 들어가있으면 지저분해지기에 파일을 조직화해서 소스 코드와 컴파일된 코드를 분리해놓아야 한다.
- 즉, 디렉토리 구조를 조직화하고 -d라는 컴파일러 옵션을 활용해 컴파일러할 때 클래스 파일을 분리해줘야 한다.
## JAR
- JAR 파일은 자바 아카이브 파일이다.
- pkzip 파일 유형을 기반으로 하며 모든 클래스를 하나로 묶을 수 있게 해주어 사용자에게는 JAR 파일 하나만 넘겨줄 수 있게 만든다.
### JAR 만드는 방법
1. 클래스 파일이 모두 한 디렉토리에 들어있는지 확인한다.
2. main()메소드가 어떤 클래스에 있는지 알려주는 manifest 파일을 만든다.
3. jar 도구를 실행시켜 classes 디렉토리에 들어있는 모든 파일이 저장된 JAR 파일을 만든다.
### JAR 실행시키는 방법
- JVM에서는 JAR에서 클래스를 불러오고 그 클래스의 main()메소드를 호출할 수 있다.
## 패키지
- 패키지를 사용하여 같은 클래스명을 가지 클래스를 다른 패키지에 두면 클래스명이 충돌하는 것을 방지할 수 있다.
- 같은 패키지명을 가지지 않게 하기 위해 모든 클래스에 역도메인 명을 붙여주는 방법을 사용한다.
### 패키지를 써서 컴파일하고 실행하는 방법
- 클래스가 패키지에 들어있으면 컴파일러와 JVM에서 클래스와 다른 필요한 클래스를 모두 찾아야 하기 때문에 컴파일과 실행방법이 조금 어려워진다.
- 한 패키지에 들어있는 모든 .java 파일을 컴파일하려면 다음과 같이 사용한다.
  - %javac -d ../classes com/kimminje/*.java
- 코드를 실행시키는 방법
  - %java com.kimminje.클래스명
### 패키지를 가지고 실행 가능한 JAR을 만드는 방법
- 패키지의 첫 번째 디렉토리는 반드시 JAR의 첫 번째 디렉토리여야만한다.
1. 클래스 파일이 classes 디렉토리 밑에 제대로 된 패키지 구조로 저장되어있는지 확인한다.
2. manifest를 만들어 main()메소드가 있는 클래스를 지정해준다.
3. jar 도구를 실행시켜 패키지 디렉토리와 manifest 파일이 들어있는 JAR 파일을 만든다.
## 자바 웹 스타트
- 자바 웹 스타트(JWS)를 사용하면 그 애플리케이션은 처음에는 웹 브라우저에서 실행되지만 그 이후에는 브라우저에 얽매이지 않고 독립형 애플리케이션처럼 실행된다.
- JWS는 클라이언트 시스템에서 돌아가는 작은 자바 프로그램인데 브라우저 플러그인과 매우 비슷하게 작동한다.(pdf를 열면 그에 맞는 플러그인이 나오는 것 처럼)
- 이런 프로그램을 JWS '보조 애플리케이션'이라 부르고 가장 중요한 역할은 JWS 애플리케이션을 내려받고 갱신하고 구동시키는 것이다.
- JWS가 애플리케이션(실행가능한 JAR)을 내려받고나면 그 애플리케이션의 main()메소드를 호출하고 한 번 하고 나면 최종 사용자는 JWS 보조 애플리케이션에서 바로 애플리케이션 디렉토리를 구동시킬 수 있다.
- JWS는 서버에 있는 애플리케이션이 조금이라도 변경되면 자동으로 갱신된 코드를 내려받고 기존 코드에 통합시켜준다.
- 결국 JWS 애플리케이션은 최종 사용자가 웹을 통해 내려받을 수 있는 실행가능한 파일과 크게 다르지 않다.
### JWS의 작동 원리
1. 클라이언트에서 개발자의 JWS 애플리케이션(.jnlp 파일)에 대한 웹 페이지 링크를 클릭한다.
2. 웹 서버(HTTP)에서 그 요청을 받은 다음 .jnlp 파일을 돌려 보낸다.
3. 브라우저에 의해 JWS(클라이언트에 있는 작은 보조 어플리케이션)가 시작된다.
4. JWS 보조 어플리케이션에서 .jnlp 파일을 읽은 다음 서버에 이름.jar 파일을 요구한다.
5. 웹 서버에서 요청받은 .jar 파일을 제공한다.
6. JWS에서 JAR을 받아서 지정된 main()메소드를 호출하여 애플리케이션을 실행한다.
   - 다음에 이 애플리케이션을 실행시킬 때는 그냥 JWS 애플리케이션을 실행시킨 다음 거기서 애플리케이션을 구동시키면 된다.(인터넷 없어도 됨)
### .jnlp 파일
- JWS 애플리케이션을 만들 때는 그 애플리케이션에 대한 설명이 들어있는 .jnlp(자바 네트워크 구동 규약)파일이 필요하다.
- JWS 애플리케이션에서 읽어서 JAR 파일을 찾아내고 그 애플리케이션을 시작하기 위한 용도로 사용된다.
### JWS에서 애플리케이션을 만들어서 배포하는 방법
1. 애플리케이션을 가지고 실행 가능한 JAR를 만든다.
2. jnlp 파일을 만든다.
3. JAR과 .jnlp 파일을 웹 서버에 저장한다.
4. 웹 서버에 새로운 mime 유형을 ㅊ ㅜ가한다.
5. .jnlp 파일에 대한 링크가 들어있는 웹 페이지를 만든다.
