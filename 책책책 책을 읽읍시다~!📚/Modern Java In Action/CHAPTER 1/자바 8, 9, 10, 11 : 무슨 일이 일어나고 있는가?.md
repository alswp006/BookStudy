# 자바 8, 9, 10, 11 : 무슨 일이 일어나고 있는가?
## 1.1 역사의 흐름은 무엇인가?
- 멀티코어 CPU 대중화와 같은 하드웨어적인 변화가 소프트웨어에도 영향을 끼치고 있다.
- 자바 8 이전까지의 자바 프로그램은 하나의 코어만 사용하고 나머지 코어를 활용하기 위해서는 스레드를 사용했다.
- 하지만 스레드를 사용하면 관리하기 어렵고 문제가 발생하기 쉽기 때문에 자바는 병렬 실행 환경을 쉽게 관리하고 에러가 덜 발생하는 방향으로 진화하려 노력했다.
- 자바 8은 간결한 코드 멀티코어 프로세서의 쉬운 활용이라는 두가지 요구사항을 기반으로 한다.
- 자바 8의 핵심 기능을 요약해보면 다음과 같다.
  - 스트림 API
    - 자바 8은 데이터베이스 질의 언어에서 표현식을 처리하는 것처럼 병렬 연산을 지원하는 스트림이라는 새로운 API를 제공한다.
    - 데이터베이스 질의 언어에서 고수준 언어로 원하는 동작을 표현하면 구현(자바 스트림 라이브러리)에서 최적의 저수준 실행 방법을 선택하는 방식으로 동작한다.
    - 즉, 스트림을 이용하면 에러를 자주 일으키며 멀티코어 CPU를 이용하는 것보다 비용이 훨씬 비싼 synchronized를 사용하지 않아도 된다. 
  - 메서드에 코드를 전달하는 기법
    - 이를 이용하면 새롭고 간결한 방식으로 동작 파라미터화를 구현할 수 있다.
    - 이 기법은 함수형 프로그래밍에서 위력을 발휘한다.
  - 인터페이스의 디폴트 메소드
## 1.2 왜 아직도 자바는 변하는가?
- 현재 모든 분야를 아우르는 완벽한 언어는 존재하지 않고 모든 언어는 장단점을 갖는다.
- c, c++는 프로그래밍 안전성은 부족하지만 작은 런타임 풋프린트라는 장점을 가지고 있고 자바, c#은 속도는 앞선 언어보다 느리지만 안정성을 가지고 있다.
- 자바는 처음부터 많고 유용한 라이브러리를 포함하는 객체지향 언어로 시작했고 스레드와 락을 이용한 소소한 동시성도 지원했다.
- 코드를 JVM 바이트 코드로 컴파일하는 특징 때문에 자바는 인터넷 애플릿 프로그램의 주요 언어가 되었다.
- 하지만 현재에 와서는 빅데이터를 효과적으로 처리해야할 필요성이 커졌고 자바도 이를 위해 진화했다.
- 자바 8 설계의 밑바탕을 이루는 세가지 프로그래밍 개념은 다음과 같다.
  1. 스트림 처리
     - 스트림이란 한 번에 한 개씩 만들어지는 연속적인 데이터 항목들의 모임이다.
     - 이론적으로 프로그램은 입력 스트림에서 데이터를 한 개씩 읽어들이며 출력 스트림은 데이터를 한 개씩 기록한다. 어떤 프로그램의 출력 스트림은 다른 프로그램의 입력 스트림이 될 수 있다.
     - 우선은 스트림 API가 조립 라인처럼 어떤 항목을 연속으로 제공하는 어떤 기능이라고 생각하자. 스트림 API는 파이프라인을 만드는 데 필요한 많은 메서드를 제공한다.
     - **스트림 API의 핵심은 우리가 하려는 작업을 데이터베이스 질의처럼 고수준으로 추상화해서 일련의 스트림으로 만들어 처리할 수 있다는 것이다.**
     - 또한 스트림 파이프라인을 이용하여 입력 부분을 여러 CPU 코어에 쉽게 할당할 수 있다는 부가적인 이득도 얻을 수 있다.
     - **스레드라는 복잡한 작업을 사용하지 않으면서도 공짜로 병렬성을 얻을 수 있다는 장점이 있다.**
  2. 동작 파라미터화로 메서드에 코드 전달하기
     - 이 기능은 코드 일부를 API로 전달하는 기능이다.
     - **자바 8에서는 메서드(내 코드)를 다른 메서드의 인수로 넘겨주는 기능을 제공한다. 이를 동작 파라미터화라고 한다.**
     - **스트림 API는 연산의 동작을 파라미터화할 수 있는 코드를 전달한다는 사상에 기초한다.**
  3. 병렬성과 공유 가변 데이터
     - 이 개념은 병렬성을 공짜로 얻을 수 있다는 말에서 시작된다.
     - 스트림 메서드로 전달하는 코드는 다른 코드와 동시에 실행하더라도 안전하게 실행될 수 있어야 한다.
     - 보통 다른 코드와 동시에 실행하더라도 안전한 코드를 만들려면 공유 가변 데이터에 접근하지 않아야 한다. 이를 pure function, side-effect-free function, stateless function 등으로 부른다.
     - 자바 8 이전에는 synchronized를 이용하여 공유된 가변 데이터를 보호하는 규칙을 만들 수 있었지만 자바 8 스트림을 이용하면 보다 쉽게 병렬성을 활용할 수 있다.
       - 일반적으로 synchronized는 시스템 성능에 악영향을 미치고 다중 프로세싱 코어에서 synchronized를 사용하면 다중 처리 코어에서는 코드가 순차적으로 실행되어야하므로 병렬이라는 목적을 무력화 시킬 수도 있다.
## 1.3 자바 함수
- 프로그래밍 언어에서 함수는 메서드, 특히 정적 메서드같은 의미로 사용되지만 자바의 함수는 이에 더해 수학적인 함수처럼 사용되며 부작용을 일으키지 않는 함수를 의미한다.
- 자바 프로그램에서 조작할 수 있는 값은 기본값(int, double 등), 객체 참조값(String, Integer, HashMap 등)이 있다. 그리고 이와 같은 값을 일급값이라 부른다.
- 다양한 구조체(메서드, 클래스 등)가 값의 구조를 표현하는데 도움이 될 수도 있지만 이러한 구조체는 자유롭게 전달될 수 없고 이들을 이급값이라 한다. 이들은 그 자체로 값이 될 수 없다.
- 자바에서는 이들을 일급값으로 취급하기 위해 자바 8에서 여러 기능을 추가했다.
  - 첫번째로는 메서드 참조이다. 
